import{a as B,b as C,N as M}from"./search-form-B1RalJR2.js";import{_ as P}from"./delete-alert-xyWbyyEK.js";import{d as w,Z as E,a0 as U,c as $,o as T,w as d,f as o,h as t,$ as a,C as O,J as z,b as F,af as b,E as J,ax as A,Y as G,ag as K,B as V,ah as q}from"./index-D7NFxYuY.js";import{a as y,b as H}from"./job-DTe4zTkx.js";import{_ as L,u as Y,a as Z}from"./table-CAj7pHJG.js";import{_ as Q}from"./select-group.vue_vue_type_script_setup_true_lang-CekkEXat.js";import{b as W}from"./Grid-OaBPjDMI.js";import"./CollapseItem-U_l2MoD9.js";import"./Alert-CS6hfMae.js";import"./group-BJHuXB4O.js";const X=w({name:"JobExecutorSearch",__name:"job-executor-search",props:{model:{required:!0},modelModifiers:{}},emits:E(["reset","search"],["update:model"]),setup(c,{emit:g}){const f=g,l=U(c,"model");function _(){f("reset")}function p(){f("search")}return(h,u)=>{const i=L,x=O,r=B;return T(),$(r,{"btn-span":"24 s:12 m:12",model:l.value,onSearch:p,onReset:_},{default:d(()=>[o(i,{span:"24 s:12 m:6",label:t(a)("page.jobTask.groupName"),path:"groupName",class:"pr-24px"},{default:d(()=>[o(Q,{value:l.value.groupName,"onUpdate:value":u[0]||(u[0]=m=>l.value.groupName=m),clearable:""},null,8,["value"])]),_:1},8,["label"]),o(i,{span:"24 s:12 m:6",label:t(a)("page.jobTask.executorInfo"),path:"executorInfo",class:"pr-24px","label-width":100},{default:d(()=>[o(x,{value:l.value.executorInfo,"onUpdate:value":u[1]||(u[1]=m=>l.value.executorInfo=m),placeholder:t(a)("page.jobTask.form.executorInfo"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])}}}),ee={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function v(c){return typeof c=="function"||Object.prototype.toString.call(c)==="[object Object]"&&!q(c)}const pe=w({name:"job_executor",__name:"index",setup(c){const g=z(),{columns:f,columnChecks:l,data:_,getData:p,loading:h,mobilePagination:u,searchParams:i,resetSearchParams:x}=Y({apiFn:H,apiParams:{page:1,size:10,groupName:null,executorInfo:null},columns:()=>[{type:"selection",align:"center",width:48},{key:"id",title:a("common.index"),align:"center",width:48},{key:"groupName",title:a("page.jobTask.groupName"),align:"center",width:120},{key:"executorInfo",title:a("page.jobTask.executorInfo"),align:"center",width:300},{key:"executorType",title:a("page.jobTask.executorType"),align:"center",width:80,render:n=>{if(n.executorType===null)return null;const e=a(A[n.executorType]);return o(G,{type:{1:"info",2:"info",3:"info"}[n.executorType]},v(e)?e:{default:()=>[e]})}},{key:"updateDt",title:a("page.jobTask.updateDt"),align:"center",width:120},{key:"operate",title:a("common.operate"),align:"center",width:80,fixed:"right",render:n=>o("div",{class:"flex-center gap-8px"},[o(K,{vertical:!0},null),o(M,{onPositiveClick:()=>j(n.id)},{default:()=>a("common.confirmDelete"),trigger:()=>{let e;return o(V,{type:"error",text:!0,ghost:!0,size:"small"},v(e=a("common.delete"))?e:{default:()=>[e]})}})])}]}),{checkedRowKeys:r,onDeleted:m,onBatchDeleted:N}=Z(_,p);async function j(n){const{error:e}=await y([n]);e||m()}async function D(){const{error:n}=await y(r.value);n||N()}return(n,e)=>{const k=P,I=C,S=W,R=J;return T(),F("div",ee,[o(X,{model:t(i),"onUpdate:model":e[0]||(e[0]=s=>b(i)?i.value=s:null),onReset:t(x),onSearch:t(p)},null,8,["model","onReset","onSearch"]),o(k),o(R,{title:"执行器列表",bordered:!1,size:"small",class:"card-wrapper sm:flex-1-hidden","header-class":"view-card-header"},{"header-extra":d(()=>[o(I,{columns:t(l),"onUpdate:columns":e[1]||(e[1]=s=>b(l)?l.value=s:null),"disabled-delete":t(r).length===0,loading:t(h),"show-add":!1,onDelete:D,onRefresh:t(p)},null,8,["columns","disabled-delete","loading","onRefresh"])]),default:d(()=>[o(S,{"checked-row-keys":t(r),"onUpdate:checkedRowKeys":e[2]||(e[2]=s=>b(r)?r.value=s:null),columns:t(f),data:t(_),"flex-height":!t(g).isMobile,"scroll-x":1e3,loading:t(h),remote:"","row-key":s=>s.id,pagination:t(u),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"])]),_:1})])}}});export{pe as default};
