import{aR as q,b as C,o as m,e as i,d as K,Z as Q,a0 as W,J as X,r as c,aA as U,p as b,c as k,P as ee,a5 as te,w as n,f as a,aH as ae,g as V,t as le,h as O,a2 as A,E as ne,ac as se,B as ue,a3 as oe,C as re,aE as x,am as ie}from"./index-D7NFxYuY.js";import{b as de}from"./table-CAj7pHJG.js";import{_ as pe,a as me}from"./cron-input.vue_vue_type_style_index_0_lang-ztTljIfZ.js";import{c as ce,d as ve}from"./Grid-OaBPjDMI.js";import{_ as ge}from"./DatePicker-CdxY6Eo2.js";const fe={class:"inline-block",viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function _e(S,u){return m(),C("svg",fe,[...u[0]||(u[0]=[i("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32zm448-64v-64H416v64zM224 896h576V256H224zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32m192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32"},null,-1)])])}const ye=q({name:"ep-delete",render:_e}),be={class:"flex items-center gap-6px"},we={class:"flex items-center gap-6px"},De={class:"flex items-center gap-6px"},Me={class:"flex items-center gap-6px"},Ne={class:"flex items-center gap-12px"},xe=K({name:"JobTriggerInterval",__name:"job-trigger-interval",props:Q({triggerType:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(S){const u=W(S,"modelValue"),p=S,z=X(),w=c(p.triggerType===2?Number(u.value):60),D=c(p.triggerType===3?u.value:"* * * * * ?"),Y=t=>{try{const e=JSON.parse(t);return Array.isArray(e)?e:[null]}catch{return[null]}},l=c(p.triggerType===5&&u.value?Y(u.value):[null]),M=c(U().add(15,"second").valueOf()),g=c("second"),N=c(10),f=c(1),L=[{label:"秒",value:"second"},{label:"分钟",value:"minute"},{label:"小时",value:"hour"},{label:"天",value:"day"},{label:"月",value:"month"},{label:"年",value:"year"}];b(w,t=>{p.triggerType===2&&(u.value=`${t}`)},{immediate:!0}),b(D,t=>{p.triggerType===3&&(u.value=t)},{immediate:!0}),b(()=>u.value,t=>{if(p.triggerType===5&&t){const e=Y(t);JSON.stringify(e)!==JSON.stringify(l.value)&&(l.value=e)}}),b(()=>p.triggerType,t=>{t===2?u.value=`${w.value}`:t===3?u.value=D.value:t===5?(M.value=U().add(60,"second").valueOf(),u.value&&(l.value=Y(u.value)),u.value=JSON.stringify(l.value)):u.value="*"},{immediate:!0}),b(l,t=>{p.triggerType===5&&(u.value=JSON.stringify(t))},{deep:!0});const j=()=>{if(x(g.value)&&x(N.value)&&x(f.value)&&f.value>0){l.value=l.value.filter(e=>x(e));const t=new Date(M.value);for(let e=0;e<f.value;e+=1){const s=U(t).add(e*N.value,g.value).format("YYYY-MM-DD HH:mm:ss");l.value.includes(s)||l.value.push(s)}return}l.value.push(null)},G=()=>{l.value.push(null)},P=t=>{l.value.splice(t,1),l.value.length===0&&l.value.push(null)},R=(t,e)=>t&&l.value.findIndex((H,d)=>d!==e&&H===t)!==-1?(window.$message?.warning(`该时间点 ${t} 已存在，请选择其他时间`),ie(()=>{l.value[e]=null}),!1):!0,F=t=>{const e=new Date,s=new Date(t);return s.getFullYear()<e.getFullYear()||s.getFullYear()===e.getFullYear()&&s.getMonth()<e.getMonth()||s.getFullYear()===e.getFullYear()&&s.getMonth()===e.getMonth()&&s.getDate()<e.getDate()},I=t=>{const e=new Date,s=new Date(t);return s.getFullYear()===e.getFullYear()&&s.getMonth()===e.getMonth()&&s.getDate()===e.getDate()?{isHourDisabled:d=>d<e.getHours(),isMinuteDisabled:(d,v)=>{const o=v??e.getHours();return o<e.getHours()?!0:o>e.getHours()?!1:d<e.getMinutes()},isSecondDisabled:(d,v,o)=>{const T=o??e.getHours(),_=v??e.getMinutes();return T<e.getHours()?!0:T>e.getHours()?!1:_<e.getMinutes()?!0:_>e.getMinutes()?!1:d<e.getSeconds()}}:{isHourDisabled:()=>!1,isMinuteDisabled:()=>!1,isSecondDisabled:()=>!1}};return(t,e)=>{const s=ae,H=pe,d=te,v=ge,o=ve,T=se,_=de,$=ue,B=ce,J=ne,E=ye,Z=re;return m(),C("div",null,[t.triggerType===2?(m(),k(d,{key:0},{default:n(()=>[a(s,{value:w.value,"onUpdate:value":e[0]||(e[0]=r=>w.value=r),placeholder:t.$t("page.jobTask.form.triggerInterval")},null,8,["value","placeholder"]),a(H,null,{default:n(()=>[V(le(t.$t("common.second")),1)]),_:1})]),_:1})):t.triggerType===3?(m(),k(O(me),{key:1,modelValue:D.value,"onUpdate:modelValue":e[1]||(e[1]=r=>D.value=r),placeholder:t.$t("page.jobTask.form.triggerInterval_CRON"),lang:O(z).locale},null,8,["modelValue","placeholder","lang"])):t.triggerType===5?(m(),C(A,{key:2},[a(J,{title:"批量生成指定时间点",size:"small",class:"mb-4"},{default:n(()=>[a(B,{cols:"24","x-gap":"12","y-gap":"12"},{default:n(()=>[a(o,{span:24},{default:n(()=>[i("div",be,[e[6]||(e[6]=i("span",{class:"w-85px"},"开始时间:",-1)),a(v,{value:M.value,"onUpdate:value":e[2]||(e[2]=r=>M.value=r),class:"w-full",clearable:"",type:"datetime",format:"yyyy-MM-dd HH:mm:ss","is-date-disabled":F,"is-time-disabled":I},null,8,["value"])])]),_:1}),a(o,{span:12},{default:n(()=>[i("div",we,[e[7]||(e[7]=i("span",{class:"w-50px"},"步长:",-1)),a(s,{value:N.value,"onUpdate:value":e[3]||(e[3]=r=>N.value=r),min:g.value==="second"?10:1,class:"w-full",placeholder:"步长"},null,8,["value","min"])])]),_:1}),a(o,{span:12},{default:n(()=>[i("div",De,[e[8]||(e[8]=i("span",{class:"w-50px"},"单位:",-1)),a(T,{value:g.value,"onUpdate:value":e[4]||(e[4]=r=>g.value=r),options:L,class:"w-full"},null,8,["value"])])]),_:1}),a(o,{span:12},{default:n(()=>[i("div",Me,[e[9]||(e[9]=i("span",{class:"w-50px"},"个数:",-1)),a(s,{value:f.value,"onUpdate:value":e[5]||(e[5]=r=>f.value=r),min:1,class:"w-full",placeholder:"个数"},null,8,["value"])])]),_:1}),a(o,{span:24},{default:n(()=>[a($,{class:"w-full",dashed:"",onClick:j},{icon:n(()=>[a(_)]),default:n(()=>[e[10]||(e[10]=V(" 批量生成 "))]),_:1,__:[10]})]),_:1})]),_:1})]),_:1}),a(J,{title:"指定时间点列表",size:"small"},{default:n(()=>[a(B,{cols:"24","x-gap":"6","y-gap":"6"},{default:n(()=>[(m(!0),C(A,null,oe(l.value,(r,y)=>(m(),k(o,{key:y,span:24},{default:n(()=>[i("div",Ne,[a(v,{"formatted-value":l.value[y],"onUpdate:formattedValue":[h=>l.value[y]=h,h=>R(h,y)],class:"w-full",clearable:"",type:"datetime",format:"yyyy-MM-dd HH:mm:ss","is-date-disabled":F,"is-time-disabled":I},null,8,["formatted-value","onUpdate:formattedValue"]),a($,{type:"error",ghost:"",onClick:h=>P(y)},{icon:n(()=>[a(E)]),default:n(()=>[e[11]||(e[11]=V(" 删除 "))]),_:2,__:[11]},1032,["onClick"])])]),_:2},1024))),128)),a(o,{span:24},{default:n(()=>[a($,{class:"mt-6px w-full",dashed:"",onClick:G},{icon:n(()=>[a(_)]),default:n(()=>[e[12]||(e[12]=V(" 新增空白选择器 "))]),_:1,__:[12]})]),_:1})]),_:1})]),_:1})],64)):t.triggerType===99?(m(),k(Z,{key:3,disabled:""})):ee("",!0)])}}});export{xe as _};
